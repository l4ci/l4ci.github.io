<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Berechne die Kosten deines Meetings in Echtzeit. Visualisiere, wie viel Zeit und Geld dein Meeting kostet.">
  <meta name="keywords" content="meeting, kosten, rechner, calculator, produktivit√§t, time tracking">
  <meta name="author" content="Meeting Cost Calculator">
  <meta name="theme-color" content="#667eea">
  
  <!-- PWA -->
  <link rel="manifest" href="./manifest.json">
  <link rel="icon" type="image/png" sizes="192x192" href="./icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="./icon-512.png">
  <link rel="apple-touch-icon" href="./icon-192.png">
  
  <title>üí∞ Meeting-Kostenrechner</title>
  
  <!-- Styles -->
  <link rel="stylesheet" href="./css/styles.css">
  
  <!-- Alpine.js -->
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body>
  
  <!-- Main App Container -->
  <div class="app-container" x-data="meetingCalculator()" x-cloak>
    
    <!-- Header -->
    <header class="app-header">
      <h1 class="app-title" x-text="t('title')">üí∞ Meeting-Kostenrechner</h1>
      <p class="app-subtitle">Visualisiere die Kosten deines Meetings in Echtzeit</p>
    </header>
    
    <!-- Main Content -->
    <main class="main-content">
      
      <!-- Calculator Card -->
      <div class="calculator-card" :class="{ 'timer-running': isRunning }">
        
        <!-- Timer Display -->
        <div class="timer-display">
          <div class="timer-label" x-text="t('elapsedTime')">Vergangene Zeit</div>
          <div class="timer-value" x-text="formattedElapsedTime">0:00</div>
        </div>
        
        <!-- Cost Display -->
        <div class="cost-display">
          <div class="cost-label" x-text="t('totalCostLabel')">Gesamtkosten:</div>
          <div class="cost-value" x-text="formattedTotalCost">0,00 ‚Ç¨</div>
        </div>
        
        <!-- Timer Controls -->
        <div class="timer-controls">
          <button 
            class="btn btn-lg"
            :class="isRunning ? 'btn-danger' : 'btn-success'"
            @click="toggleTimer()"
            :aria-label="isRunning ? t('pause') : t('start')"
          >
            <span x-show="!isRunning">‚ñ∂Ô∏è</span>
            <span x-show="isRunning">‚è∏Ô∏è</span>
            <span x-text="isRunning ? t('pause') : t('start')">Start</span>
          </button>
          
          <button 
            class="btn btn-lg btn-secondary"
            @click="resetTimer()"
            :aria-label="t('reset')"
          >
            üîÑ <span x-text="t('reset')">Reset</span>
          </button>
        </div>
        
        <!-- Controls Section -->
        <div class="controls-section">
          
          <!-- People Counter -->
          <div class="control-group">
            <label class="control-label" x-text="t('participants')">Teilnehmer</label>
            <div class="people-counter">
              <button 
                class="people-counter-btn"
                @click="updatePeopleCount(-1)"
                :disabled="currentPeopleCount <= 1"
                aria-label="Teilnehmer verringern"
              >
                ‚àí
              </button>
              
              <input 
                type="number"
                class="people-counter-input"
                x-model.number="currentPeopleCount"
                @change="onPeopleInputChange()"
                min="1"
                max="100"
                :aria-label="t('numberOfPeople')"
              >
              
              <button 
                class="people-counter-btn"
                @click="updatePeopleCount(1)"
                :disabled="currentPeopleCount >= 100"
                aria-label="Teilnehmer erh√∂hen"
              >
                +
              </button>
            </div>
          </div>
          
          <!-- Cost Per Person -->
          <div class="control-group">
            <label class="control-label" for="costInput" x-text="t('costPerPerson')">
              Kosten pro Person (‚Ç¨/Std)
            </label>
            <input 
              type="number"
              id="costInput"
              class="form-input"
              x-model.number="costPerPerson"
              @change="updateCost()"
              min="0"
              max="10000"
              step="0.01"
            >
          </div>
          
          <!-- Currency Selector -->
          <div class="control-group">
            <label class="control-label" for="currencySelect" x-text="t('currency')">
              W√§hrung
            </label>
            <select 
              id="currencySelect"
              class="form-select"
              x-model="currency"
              @change="updateCost()"
            >
              <option value="EUR">‚Ç¨ Euro (EUR)</option>
              <option value="USD">$ US Dollar (USD)</option>
              <option value="GBP">¬£ Britisches Pfund (GBP)</option>
              <option value="CHF">CHF Schweizer Franken (CHF)</option>
              <option value="JPY">¬• Japanischer Yen (JPY)</option>
              <option value="CNY">¬• Chinesischer Yuan (CNY)</option>
            </select>
          </div>
          
        </div>
        
        <!-- History Section -->
        <div class="history-section" x-show="segments.length > 1">
          <button 
            class="history-toggle"
            @click="historyOpen = !historyOpen"
            :aria-expanded="historyOpen"
          >
            <span x-text="historyOpen ? t('historyHide') : t('historyShow')">
              üìä Meeting-Historie anzeigen
            </span>
          </button>
          
          <ul class="history-list" x-show="historyOpen" x-transition>
            <template x-for="(segment, index) in segments" :key="index">
              <li class="history-item" x-text="formatHistoryEntry(segment, index)"></li>
            </template>
          </ul>
        </div>
        
      </div>
      
      <!-- Action Buttons -->
      <div class="button-group mt-4">
        <button 
          class="btn btn-primary"
          @click="openShareModal()"
          aria-label="Session teilen"
        >
          üì§ <span x-text="t('shareSession')">Session teilen</span>
        </button>
        
        <button 
          class="btn btn-secondary"
          @click="openInfoModal()"
          aria-label="Informationen anzeigen"
        >
          ‚ÑπÔ∏è <span x-text="t('info')">Info</span>
        </button>
        
        <button 
          class="btn btn-secondary"
          @click="toggleTheme()"
          aria-label="Theme wechseln"
        >
          <span x-show="theme === 'light'">üåô</span>
          <span x-show="theme === 'dark'">‚òÄÔ∏è</span>
          <span x-show="theme === 'auto'">üåì</span>
        </button>
        
        <button 
          class="btn btn-secondary"
          @click="openShortcutsModal()"
          aria-label="Tastaturk√ºrzel anzeigen"
        >
          ‚å®Ô∏è <span x-text="t('keyboardShortcuts')">Shortcuts</span>
        </button>
      </div>
      
    </main>
    
    <!-- Info Modal -->
    <div 
      class="modal-backdrop"
      x-show="infoOpen"
      @click.self="closeInfoModal()"
      x-transition
      style="display: none;"
      role="dialog"
      aria-modal="true"
      :aria-labelledby="'info-modal-title'"
    >
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="info-modal-title" class="modal-title" x-text="t('info')">Info</h2>
          <button 
            class="modal-close"
            @click="closeInfoModal()"
            aria-label="Dialog schlie√üen"
          >
            √ó
          </button>
        </div>
        <div class="modal-body">
          <p class="mb-2" x-text="t('infoText1')">
            Dieser Rechner hilft dir, die Kosten deines Meetings in Echtzeit zu visualisieren.
          </p>
          <p class="mb-2" x-text="t('infoText2')">
            Gib die Anzahl der Teilnehmer und die durchschnittlichen Kosten pro Person und Stunde ein.
          </p>
          <p class="mb-3" x-text="t('infoText3')">
            Der Timer zeigt dir, wie viel das Meeting bereits gekostet hat.
          </p>
          
          <div style="padding: 1rem; background: var(--surface-hover); border-radius: var(--radius-md); border-left: 4px solid var(--primary-color);">
            <strong x-text="t('proTip')">Profi-Tipp:</strong>
            <span x-text="t('infoTip')">
              Nutze Tastaturk√ºrzel f√ºr schnellere Bedienung! Dr√ºcke Ctrl+? um alle Shortcuts zu sehen.
            </span>
          </div>
        </div>
        <div class="modal-footer">
          <button 
            class="btn btn-primary"
            @click="closeInfoModal()"
          >
            <span x-text="t('close')">Schlie√üen</span>
          </button>
        </div>
      </div>
    </div>
    
    <!-- Share Modal -->
    <div 
      class="modal-backdrop"
      x-show="shareOpen"
      @click.self="closeShareModal()"
      x-transition
      style="display: none;"
      role="dialog"
      aria-modal="true"
      :aria-labelledby="'share-modal-title'"
    >
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="share-modal-title" class="modal-title" x-text="t('shareTitle')">
            Session teilen
          </h2>
          <button 
            class="modal-close"
            @click="closeShareModal()"
            aria-label="Dialog schlie√üen"
          >
            √ó
          </button>
        </div>
        <div class="modal-body">
          <p class="mb-3" x-text="t('shareDescription')">
            Teile deine Meeting-Kosten mit anderen:
          </p>
          
          <!-- Share URL -->
          <div class="share-url-container">
            <input 
              type="text"
              class="share-url-input"
              :value="shareUrl"
              readonly
              @click="$event.target.select()"
            >
            <button 
              class="btn btn-primary"
              @click="copyShareUrl()"
              :disabled="copied"
            >
              <span x-show="!copied" x-text="t('copy')">Kopieren</span>
              <span x-show="copied">‚úì</span>
            </button>
          </div>
          
          <!-- Share Buttons -->
          <div class="share-buttons">
            <button class="share-button" @click="shareViaEmail()">
              <span class="share-button-icon">üìß</span>
              <span class="share-button-text" x-text="t('email')">E-Mail</span>
            </button>
            
            <button class="share-button" @click="shareViaWhatsApp()">
              <span class="share-button-icon">üí¨</span>
              <span class="share-button-text">WhatsApp</span>
            </button>
            
            <button class="share-button" @click="shareViaSlack()">
              <span class="share-button-icon">üíº</span>
              <span class="share-button-text">Slack</span>
            </button>
            
            <button 
              class="share-button" 
              @click="shareViaNative()"
              x-show="canUseNativeShare"
            >
              <span class="share-button-icon">üì±</span>
              <span class="share-button-text" x-text="t('share')">Teilen</span>
            </button>
          </div>
        </div>
        <div class="modal-footer">
          <button 
            class="btn btn-secondary"
            @click="closeShareModal()"
          >
            <span x-text="t('close')">Schlie√üen</span>
          </button>
        </div>
      </div>
    </div>
    
    <!-- Keyboard Shortcuts Modal -->
    <div 
      class="modal-backdrop"
      x-show="shortcutsOpen"
      @click.self="closeShortcutsModal()"
      x-transition
      style="display: none;"
      role="dialog"
      aria-modal="true"
      :aria-labelledby="'shortcuts-modal-title'"
    >
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="shortcuts-modal-title" class="modal-title" x-text="t('keyboardShortcuts')">
            Tastaturk√ºrzel
          </h2>
          <button 
            class="modal-close"
            @click="closeShortcutsModal()"
            aria-label="Dialog schlie√üen"
          >
            √ó
          </button>
        </div>
        <div class="modal-body">
          <p class="mb-3" x-text="t('keyboardShortcutsDescription')">
            Nutze diese Tastenkombinationen f√ºr schnellere Bedienung:
          </p>
          
          <div class="shortcuts-list">
            <div class="shortcut-item">
              <span class="shortcut-description" x-text="t('startPauseTimer')">
                Timer starten/pausieren
              </span>
              <div class="shortcut-keys">
                <kbd class="shortcut-key">Enter</kbd>
                <span x-text="t('or')">oder</span>
                <kbd class="shortcut-key">Space</kbd>
              </div>
            </div>
            
            <div class="shortcut-item">
              <span class="shortcut-description" x-text="t('resetTimer')">
                Timer zur√ºcksetzen
              </span>
              <div class="shortcut-keys">
                <kbd class="shortcut-key">Ctrl</kbd>
                <kbd class="shortcut-key">R</kbd>
              </div>
            </div>
            
            <div class="shortcut-item">
              <span class="shortcut-description" x-text="t('adjustParticipants')">
                Teilnehmer anpassen
              </span>
              <div class="shortcut-keys">
                <kbd class="shortcut-key">+</kbd>
                <kbd class="shortcut-key">‚àí</kbd>
              </div>
            </div>
            
            <div class="shortcut-item">
              <span class="shortcut-description" x-text="t('openInfo')">
                Info √∂ffnen
              </span>
              <div class="shortcut-keys">
                <kbd class="shortcut-key">Ctrl</kbd>
                <kbd class="shortcut-key">I</kbd>
              </div>
            </div>
            
            <div class="shortcut-item">
              <span class="shortcut-description" x-text="t('openShare')">
                Teilen-Dialog √∂ffnen
              </span>
              <div class="shortcut-keys">
                <kbd class="shortcut-key">Ctrl</kbd>
                <kbd class="shortcut-key">S</kbd>
              </div>
            </div>
            
            <div class="shortcut-item">
              <span class="shortcut-description" x-text="t('showShortcuts')">
                Shortcuts anzeigen
              </span>
              <div class="shortcut-keys">
                <kbd class="shortcut-key">Ctrl</kbd>
                <kbd class="shortcut-key">?</kbd>
              </div>
            </div>
            
            <div class="shortcut-item">
              <span class="shortcut-description" x-text="t('closeModal')">
                Dialog schlie√üen
              </span>
              <div class="shortcut-keys">
                <kbd class="shortcut-key">Esc</kbd>
              </div>
            </div>
          </div>
          
          <p class="mt-3 text-center" style="font-size: 0.875rem; color: var(--text-secondary);" x-text="t('keyboardShortcutsTip')">
            Alle Shortcuts funktionieren auch w√§hrend das Meeting l√§uft!
          </p>
        </div>
        <div class="modal-footer">
          <button 
            class="btn btn-primary"
            @click="closeShortcutsModal()"
          >
            <span x-text="t('close')">Schlie√üen</span>
          </button>
        </div>
      </div>
    </div>
    
  </div>
  
  <!-- Emoji Container (dynamically populated) -->
  <div id="emojiContainer" class="emoji-container" aria-hidden="true"></div>
  
  <!-- Notification Container (dynamically populated) -->
  <div id="notificationContainer" class="notification-container" aria-live="polite" aria-atomic="true"></div>
  
  <!-- Scripts -->
  <script src="./js/config.js"></script>
  <script src="./js/translations.js"></script>
  <script src="./js/utils.js"></script>
  <script src="./js/formatters.js"></script>
  <script src="./js/storage.js"></script>
  <script src="./js/timer.js"></script>
  <script src="./js/notifications.js"></script>
  <script src="./js/emojis.js"></script>
  <script src="./js/modals.js"></script>
  <script src="./js/app.js"></script>
  
</body>
</html>
